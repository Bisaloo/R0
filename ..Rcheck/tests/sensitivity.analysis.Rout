
R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin21.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #Loading package
> library(R0)
Loading required package: MASS
> 
> ## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
> ## outbreak during 1918 influenza pandemic in Germany)
> data(Germany.1918)
> 
> ## For this exemple, we use the exact same call as for the internal sensitivity analysis function
> 
> ## sa.type = "GT"
> 
> ## Here we will test GT with means of 1 to 5, each time with SD constant (1)
> ## GT and SD can be either fixed value or vectors of values
> ## Actual value in simulations may differ, as they are adapted according to the distribution type
> tmp<-sensitivity.analysis(sa.type="GT", incid=Germany.1918, GT.type="gamma", GT.mean=seq(1,5,1), 
+                           GT.sd.range=1, begin=1, end=27, est.method="EG")
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
> 
> ## Results are stored in a matrix, each line dedicated to a (mean,sd) couple
> plot(x=tmp[,"GT.Mean"], xlab="mean GT (days)", y=tmp[,"R"], ylim=c(1.2, 2.1), ylab="R0 (95% CI)", 
+      type="p", pch=19, col="black", main="Sensitivity of R0 to mean GT")
> arrows(x0=as.numeric(tmp[,"GT.Mean"]), y0=as.numeric(tmp[,"CI.lower"]), 
+        y1=as.numeric(tmp[,"CI.upper"]), angle=90, code=3, col="black", length=0.05)
> ## One could tweak this example to change sorting of values (per mean, or per standard deviation)
> ## eg: 'x=tmp[,c('GT.Mean')]' could become 'x=tmp[,c('GT.SD')]'
> 
> 
> ## sa.type="time"
> 
> mGT<-generation.time("gamma", c(2.6,1))
> sen=sensitivity.analysis(sa.type="time", incid=Germany.1918, GT=mGT, begin=1:15, end=16:30, 
+                          est.method="EG")
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...
Warning message:
If 'begin' and 'end' overlap, cases where begin >= end are skipped.
These cases often return Rsquared = 1 and are thus ignored. 
> # ...
> # Warning message:
> # If 'begin' and 'end' overlap, cases where begin >= end are skipped.
> # These cases often return Rsquared = 1 and are thus ignored.
> ## A list with different estimates of reproduction ratio, exponential growth rate and 95%CI 
> ## wtih different pairs of begin and end dates in form of data frame is returned.
> ## If method is "EG", results will include growth rate and deviance R-squared measure
> ## Else, if "ML" method is used, growth rate and R-squared will be set as NA
> 
> ## Interesting results include the variation of R0 given specific begin/end dates.
> ## Such results can be plot as a colored matrix and display Rsquared=f(time period)
> plot(sen, what=c("criterion","heatmap"))
dev.new(): using pdf(file="Rplots2.pdf")
$max.Rsquared
    Time.period Begin.dates  End.dates         R Growth.rate  Rsquared
211           1  1918-10-13 1918-10-14 0.7966431 -0.07232066 1.0000000
212           2  1918-10-13 1918-10-15 1.4638654  0.12578511 0.5780246
213           3  1918-10-13 1918-10-16 1.5701682  0.14956841 0.8301796
198           4  1918-10-12 1918-10-16 1.4607124  0.12505680 0.8366304
215           5  1918-10-13 1918-10-18 1.4880327  0.13132209 0.9102327
216           6  1918-10-13 1918-10-19 1.5323805  0.14128057 0.9471691
217           7  1918-10-13 1918-10-20 1.5261663  0.13990050 0.9658279
202           8  1918-10-12 1918-10-20 1.4978208  0.13354223 0.9661954
187           9  1918-10-11 1918-10-20 1.5517552  0.14555209 0.9529012
172          10  1918-10-10 1918-10-20 1.5483504  0.14480483 0.9615177
157          11  1918-10-09 1918-10-20 1.5514000  0.14547419 0.9683531
142          12  1918-10-08 1918-10-20 1.5752136  0.15066175 0.9684254
127          13  1918-10-07 1918-10-20 1.5649826  0.14844150 0.9711261
112          14  1918-10-06 1918-10-20 1.5733082  0.15024920 0.9744284
97           15  1918-10-05 1918-10-20 1.5621823  0.14783160 0.9752564
82           16  1918-10-04 1918-10-20 1.5766385  0.15096994 0.9749691
67           17  1918-10-03 1918-10-20 1.5985892  0.15568739 0.9683783
52           18  1918-10-02 1918-10-20 1.5868765  0.15317733 0.9684990
37           19  1918-10-01 1918-10-20 1.6030326  0.15663542 0.9655641
22           20  1918-09-30 1918-10-20 1.6148899  0.15915397 0.9654262
7            21  1918-09-29 1918-10-20 1.6103334  0.15818806 0.9672862
8            22  1918-09-29 1918-10-21 1.5542958  0.14610872 0.9448535
57           23  1918-10-02 1918-10-25 1.4394676  0.12011333 0.9449942
10           24  1918-09-29 1918-10-23 1.4997967  0.13398885 0.9424691
11           25  1918-09-29 1918-10-24 1.4792914  0.12932852 0.9437630
12           26  1918-09-29 1918-10-25 1.4615201  0.12524349 0.9456652
13           27  1918-09-29 1918-10-26 1.4329356  0.11858051 0.9354416
14           28  1918-09-29 1918-10-27 1.4088026  0.11286372 0.9281762
15           29  1918-09-29 1918-10-28 1.3858604  0.10734878 0.9199849
     CI.lower CI.upper
211 0.2829317 1.993745
212 0.9419193 2.229713
213 1.2073751 2.029051
198 1.2066743 1.762760
215 1.3038296 1.696242
216 1.3863578 1.693025
217 1.4102434 1.651379
202 1.3991827 1.603384
187 1.4602558 1.649198
172 1.4661091 1.635517
157 1.4761521 1.630877
142 1.5042459 1.650019
127 1.4995570 1.633778
112 1.5114270 1.638288
97  1.5044350 1.622720
82  1.5209417 1.635001
67  1.5440707 1.655724
52  1.5352480 1.640930
37  1.5523158 1.656148
22  1.5650942 1.667056
7   1.5622559 1.660686
8   1.5125261 1.597855
57  1.4110750 1.468726
10  1.4665869 1.534212
11  1.4493938 1.510194
12  1.4344734 1.489413
13  1.4085967 1.457980
14  1.3867572 1.431443
15  1.3658166 1.406409

$best.R0.values
 [1] 0.7966431 1.4638654 1.5701682 1.4607124 1.4880327 1.5323805 1.5261663
 [8] 1.4978208 1.5517552 1.5483504 1.5514000 1.5752136 1.5649826 1.5733082
[15] 1.5621823 1.5766385 1.5985892 1.5868765 1.6030326 1.6148899 1.6103334
[22] 1.5542958 1.4394676 1.4997967 1.4792914 1.4615201 1.4329356 1.4088026
[29] 1.3858604

$best.fit
   Time.period Begin.dates  End.dates        R Growth.rate  Rsquared CI.lower
97          15  1918-10-05 1918-10-20 1.562182   0.1478316 0.9752564 1.504435
   CI.upper
97  1.62272

> ## Returns complete data.frame of best R0 value for each time period 
> ## (allows for quick visualization)
> ## The "best.fit" is the time period over which the estimate is the more robust
> 
> # $best.fit
> #    Time.period Begin.dates  End.dates       R Growth.rate  Rsquared CI.lower. CI.upper.
> # 92          15  1970-01-08 1970-01-23 1.64098   0.1478316 0.9752564  1.574953  1.710209
> 
> proc.time()
   user  system elapsed 
  3.919   0.090   4.033 
